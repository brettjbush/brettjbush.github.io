<!DOCTYPE html>
<html>
<head>
  <style>
    td {
      width: 50px;
      padding: 5px;
    }
    table {
      border-style: solid;
    }
    .box {
      position: absolute;
      left: 400px;
      top: 500px;
      z-index: -1;
      background-color: #00ff00;
      width: 50px;
      height: 50px;
    }
    .box-2 {
      position: absolute;
      left: 400px;
      top: 500px;
      z-index: -2;
      background-color: #0000ff;
      width: 50px;
      height: 50px;
    }
    .shadow-box {
      border: 1px solid;
      padding: 10px;
      box-shadow: 0px 0px 20px #888888;
    }
  </style>
</head>
<body>
  <h1>Test</h1>
  <h3>Current</h3>
  <table>
    <tr><th>Alpha</th><th>Beta</th><th>Gamma</th></tr>
    <tr><td id="alpha">0</td><td id="beta">0</td><td id="gamma">0</td></tr>
  </table>
  <h3>Delta from Original</h3>
  <table>
    <tr><th>Alpha</th><th>Beta</th><th>Gamma</th></tr>
    <tr><td id="delta-alpha">0</td><td id="delta-beta">0</td><td id="delta-gamma">0</td></tr>
  </table>
  <h3>Offset Delta=2</h3>
  <table>
    <tr><th>Top</th><th>Left</th></tr>
    <tr><td id="top-delta-2">0</td><td id="left-delta-2">0</td></tr>
  </table>
  <!--<div id="theBox" class="box"></div>
  <div id="theBox2" class="box-2"></div>-->
  <div class="shadow-box"><p>Hello World</p></div>
  <script>

  var alpha = document.getElementById("alpha");
  var beta = document.getElementById("beta");
  var gamma = document.getElementById("gamma");

  var deltaAlpha = document.getElementById("delta-alpha");
  var deltaBeta = document.getElementById("delta-beta");
  var deltaGamma = document.getElementById("delta-gamma");

  var topDelta = document.getElementById("top-delta-2");
  var leftDelta = document.getElementById("left-delta-2");

  var box = document.getElementById("theBox");
  var box2 = document.getElementById("theBox2");
    
  var shadowBoxes = document.getElementByClass("shadow-box");

  var defaultBoxTop = 500;
  var defaultBoxLeft = 400;

  var depthConstant = 40;
  var depthConstant2 = 80;

  var originalAlpha = 0;
  var originalBeta = 0;
  var originalGamma = 0;
    
    
  var currentBeta = 0;
  var currentGamma = 0;
  
  var first = true;

  var degtorad = Math.PI / 180; // Degree-to-Radian conversion

  function calcOffset(depth, angle) {

    var offsetValue = Math.tan(Math.abs(angle) * degtorad) * depth;

    if(angle > 0)
    {
      offsetValue = offsetValue * -1;
    }

    return offsetValue;
  }

  window.addEventListener("deviceorientation", function(event) {
          if(first)
          {
            var initAlphaNum = event.alpha;
            var initNewNum = 0;
            if(initAlphaNum <= 180)
            {
              initNewNum = initAlphaNum;
            }
            else
            {
              initNewNum = (initAlphaNum % 180) - 180;
            }
            originalAlpha = Number(initNewNum).toFixed(1);
            originalBeta = Number(event.beta).toFixed(1);
            originalGamma = Number(event.gamma).toFixed(1);
            first = false;
          }

          if(event.alpha != null)
          {
            var alphaNum = event.alpha;
            var newNum = 0;
            if(alphaNum <= 180)
            {
              newNum = alphaNum;
            }
            else
            {
              newNum = (alphaNum % 180) - 180;
            }
            alpha.innerHTML = Number(newNum).toFixed(1);
            var deltaAlphaValue = newNum - originalAlpha;
            deltaAlpha.innerHTML = Number(deltaAlphaValue).toFixed(1);
          }
          if(event.beta != null)
          {
            beta.innerHTML = Number(event.beta).toFixed(1);
            var deltaBetaValue = event.beta - originalBeta;
            deltaBeta.innerHTML = Number(deltaBetaValue).toFixed(1);
            var topOffsetValue = Number(calcOffset(depthConstant, deltaBetaValue)).toFixed(1);
            topDelta.innerHTML = topOffsetValue;
            var newTopOffset = defaultBoxTop - calcOffset(depthConstant, deltaBetaValue);
            //box.style.top = Number(newTopOffset).toFixed(0) + "px";
            
            var newTopOffset2 = defaultBoxTop - calcOffset(depthConstant2, deltaBetaValue);
            //box2.style.top = Number(newTopOffset2).toFixed(0) + "px";
            
            currentBeta = parseInt(Number(calcOffset(depthConstant2, deltaBetaValue)).toFixed(0));
          }
          if(event.gamma != null)
          {
            gamma.innerHTML = Number(event.gamma).toFixed(1);
            var deltaGammaValue = event.gamma - originalGamma;
            deltaGamma.innerHTML = Number(deltaGammaValue).toFixed(1);
            var leftOffsetValue = Number(calcOffset(depthConstant, deltaGammaValue)).toFixed(1);
            leftDelta.innerHTML = leftOffsetValue;
            var newLeftOffset = defaultBoxLeft + calcOffset(depthConstant, deltaGammaValue);
            //box.style.left = Number(newLeftOffset).toFixed(0) + "px";
            
            var newLeftOffset2 = defaultBoxLeft + calcOffset(depthConstant2, deltaGammaValue);
            //box2.style.left = Number(newLeftOffset2).toFixed(0) + "px";
            
            currentGamma = parseInt(Number(calcOffset(depthConstant2, deltaGammaValue)).toFixed(0));
            
          }

          for(int i = 0; i < shadowBoxes.length; i++)
          {
            shadowBoxes[i].style.boxShadow = currentBeta.toString() + "px " + currentGamma.toString() + "px 20px #888888";
          }

      }, true);

  function alertFunc() {

  }
  </script>
</body>
</html>
